<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept
  PUBLIC "-//OASIS//DTD DITA Concept//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/concept.dtd">
<concept id="dg-xpath-function">
  <title>XPath: oxy_xpath() Function</title>
  <shortdesc>This function is used to evaluate XPath expressions.</shortdesc>
  <prolog>
    <metadata>
      <keywords>
        <indexterm>CSS extensions<indexterm>Custom
            functions<indexterm>oxy_xpath</indexterm></indexterm>
        </indexterm>
      </keywords>
    </metadata>
  </prolog>
  <conbody>
    <p>
      <dl>
        <dlentry>
          <dt>Syntax:</dt>
          <dd>
            <p>
              <syntaxdiagram>
                <groupseq>
                  <kwd>oxy_xpath</kwd>
                  <sep>(</sep>
                  <kwd>XPathExpression</kwd>
                  <sep>[,</sep>
                  <kwd>processChangeMarkers</kwd>
                  <sep>,</sep>
                  <kwd>value</kwd>
                  <sep>]</sep>
                  <sep>[,</sep>
                  <kwd>evaluate</kwd>
                  <sep>,</sep>
                  <kwd>value</kwd>
                  <sep>])</sep>
                </groupseq>
              </syntaxdiagram>
            </p>
            <p>It evaluates the given XPath 2.0 expression using Saxon 9 and returns the result.
              XPath expressions that depend on the cursor location can be successfully evaluated
              only when the cursor is located in the actual XML content. Evaluation fails when the
              current editing context is inside a referenced <b>xi:include</b> section or inside
              artificially referenced content (for example, DITA <xmlatt>conref</xmlatt> or
                <xmlatt>topicref</xmlatt> references).</p>
            <p>The parameters of the function are as follows: <ul id="ul_g4l_r5j_4r">
                <li>A required <codeph>expression</codeph> parameter, which is the XPath expression
                  to be evaluated. </li>
                <li>An optional <codeph>processChangeMarkers</codeph> parameter, followed by its
                  value, which can be either <codeph>true</codeph> or <codeph>false</codeph>
                  (default value). When you set the parameter to <codeph>true</codeph>, the function
                  returns the resulting text with all the change markers accepted (<i>delete</i>
                  changes are removed and <i>insert</i> changes are preserved). </li>
                <li>An optional <codeph>evaluate</codeph> parameter, followed by its value, which
                  can be one of the following:<ul id="ul_m32_lv3_qr">
                    <li><b>dynamic</b> - Evaluates the XPath each time there are changes in the
                      document.</li>
                    <li><b>dynamic-once</b> - Separately evaluates the XPath for each node that
                      matches the CSS selector. It will not re-evaluate the expression when changes
                      are made to other nodes in the document. This will lead to improved
                      performance, but the displayed content may not be updated to reflect the
                      actual document content.</li>
                    <li><b>static</b> - If the same XPath is evaluated on several nodes, the result
                      for the first evaluation will be used for all other matches. Use this only if
                      the XPath does not contain a relationship with the node on which the CSS
                      property is evaluated. This will lead to improved performance, but the static
                      displayed content may not be updated to reflect the actual document
                        content.<note>When XPath expressions are evaluated, the entities and
                          <xmlelement>xi:include</xmlelement> elements are replaced with the actual
                        content that is referenced. For example, consider the following code
                        snippet:<codeblock outputclass="language-xml">&lt;article>
  &lt;xi:include href="section1.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
&lt;/article></codeblock>where
                          <filepath>section1.xml</filepath> contains the following
                        content:<codeblock outputclass="language-xml">&lt;section>
  &lt;p>Referenced content&lt;/p>
&lt;/section></codeblock>The
                        XPath expression will be executed over the actual content in the
                          <filepath>section1.xml</filepath> file.</note></li>
                  </ul></li>
              </ul></p>
          </dd>
        </dlentry>
      </dl>
    </p>
    <p><b><u>Example: <i>oxy_xpath</i> Function</u></b></p>
    <p>The following example counts the number of words from a paragraph (including <xref
        keyref="glossentry_track-changes"><term>tracked changes</term></xref>) and displays the
      result in front of
      it:<codeblock outputclass="language-css">para:before{ 
  content: 
   concat("|Number of words:", 
    oxy_xpath(
        "count(tokenize(normalize-space(string-join(text(), '')), ' '))",
        processChangeMarkers,
       true),
    "| "); 
}</codeblock></p>
    <p>
      <note>The <codeph>oxy_xpath()</codeph> function supports <xref
          href="editor-variables.dita#editor-variables"><term>editor variables</term></xref>, as in
        the following
        example:<codeblock outputclass="language-css">* {
    content: 
    oxy_concat("Result: ", 
        oxy_xpath('count(collection("${cfdu}/?select=*.xml"))')
    );
}</codeblock></note>
    </p>
  </conbody>
</concept>
